!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).NEUX={})}(this,(function(e){"use strict";let t;function n(e,n){if(t)throw Error("Collision in state binding");const o=t=new Map,c=e();t=null;for(const e of o){const[t,o]=e;for(const e in o)n(t,e,o[e])}return c}function o(e,n,o){if(!t)return;const c=t.get(e)||{};c[n]=o||null,t.set(e,c)}class c{constructor(){this._list={}}on(e,t){if(e&&t){const n=this._list,o=[].concat(e);for(const e of o)n[e]||(n[e]=new Map),n[e].set(t,!1)}}once(e,t){if(e&&t){const n=this._list,o=[].concat(e);for(const e of o)n[e]||(n[e]=new Map),n[e].set(t,!0)}}off(e,t){if(e){const n=this._list,o=[].concat(e);for(const e of o)n[e]&&(t?(n[e].delete(t),n[e].size||delete n[e]):(n[e].clear(),delete n[e]))}}emit(e,...t){const n=this._list;if("*"===e)for(const e in n)for(const[o,c]of n[e])o(...t),c&&this.off(e,o);else{const o=new Set([].concat(e));for(const e of o)if(n[e])for(const[o,c]of n[e])o(...t),c&&this.off(e,o)}}}function r(e){return void 0===e}function s(e){return"function"==typeof e}function i(e){return"string"==typeof e}function f(e){return Array.isArray(e)}function a(e){return"object"==typeof e&&null!==e&&(e.constructor===Object||e.constructor===Array)}function l(e,t){return a(e)&&Object.prototype.hasOwnProperty.call(e,t)}const u=Symbol("isProxy");function d(e){if(r(e)&&(e={}),e[u]||!a(e))return e;const t=/^\$/,n=new c,m=new c,$=new c,y=new Proxy(e,{get:(e,c,r)=>c===u||("$"===c?function(e){return r["$"+e]}:"$$on"===c?function(e,t){return n.on(e,t)}:"$$once"===c?function(e,t){return n.once(e,t)}:"$$off"===c?function(e,t){return n.off(e,t)}:"$$emit"===c?function(e,...t){return n.emit(e,...t)}:"$$each"===c&&f(e)?function(t,n){return o(this,"$each",t),e.map(t,n).filter((e=>e))}:(i(c)&&t.test(c)&&(c=c.slice(1),s(e[c])||o(r,c)),Reflect.get(e,c))),set:(e,t,o,c)=>{s(o)&&(o=p(c,t,o,m)),a(o)&&(o=d(o),h(c,t,o,$));const r=f(e)&&"length"===t||e[t]!==o,i=r&&g(e);if(!Reflect.set(e,t,o))return!1;if(r){const c=[t],r=l(i,t)?"#mod":"#add";f(e)&&isNaN(t)||c.push(r,"*");(async()=>n.emit(c,o,t,i))()}return!0},deleteProperty:(e,t)=>{const o=g(e);if(!Reflect.deleteProperty(e,t))return!1;m.emit(t),$.emit(t);const c=[t,"#del","*"];return(async()=>{n.emit(c,void 0,t,o)})(),!0}});for(const t in e)if(s(e[t])&&(e[t]=p(y,t,e[t],m)),a(e[t])){const n=d(e[t]);e[t]=n,h(y,t,n,$)}return y}function p(e,t,o,c){c.emit(t);const r=()=>{e[t]=o(e,t)};return n((()=>o(e,t)),((e,n)=>{e.$$on(n,r),c.once(t,(()=>e.$$off(n,r)))}))}function h(e,t,n,o){if(!n[u])return;o.emit(t);const c=(...t)=>{e.$$emit(["*"],...t)};n.$$on("*",c),o.once(t,(()=>n.$$off("*",c)))}function m(e,t){const n=f(e);for(const o in t)if(a(t[o]))if(a(e[o]))m(e[o],t[o]);else{const c=d(f(t[o])?[]:{});m(c,t[o]),n?e.splice(o,1,c):e[o]=c}else r(t[o])||(n?e.splice(o,1,t[o]):e[o]=t[o]);if(n){const n=f(t)?t.length:0,o=e.length-n;o>0&&e.splice(n,o)}else for(const n in e)l(t,n)||delete e[n]}function $(e,t){if(a(e)&&a(t)){for(const n in t)if(!l(e,n))return!1;for(const n in e)if(!$(e[n],t[n]))return!1}else if(e!==t)return!1;return!0}function y(e,t){if(f(e)){const n=[],o=[],c=[],r={};f(t)||(t=[]);for(let e=0;e<t.length;e++){const n=t[e];a(n)&&(l(n,"id")?r[n.id]=n:r[e]=n)}const s={};for(let t=0;t<e.length;t++){const o=e[t];if(!a(o))continue;let i;if(l(o,"id")?(i=o.id,s[i]=o):(i=t,s[i]=o),l(r,i)){const e=r[i],t={id:i};let n;for(const c in o)$(o[c],e[c])||(t[c]=o[c],n=!0);for(const c in e)l(o,c)||(t[c]=null,n=!0);n&&c.push(g(t))}else n.push(g(o))}for(const e in r){const t=r[e];l(s,e)||o.push(g(t))}return(n.length>0||c.length>0||o.length>0)&&{add:n,mod:c,del:o}}{const n={};let o=!1;for(const c in e)$(e[c],t[c])||(n[c]=e[c],o=!0);for(const c in t)l(e,c)||(n[c]=null,o=!0);return o&&n}}function g(e){if(!a(e))return e;const t=f(e)?[]:{};for(const n in e)t[n]=g(e[n]);return t}function w(e,t){if(s(e))return w(e());if(!a(e))return;const o={...e};let l;if(o.view){if(l=o.view,delete o.view,s(l))return w(l(o));if(i(l)){const e=document.createElement("div");return e.innerHTML=l,o.view=e.firstChild,w(o)}}t||"SVG"!==`${o.tagName}`.toUpperCase()||(t="http://www.w3.org/2000/svg");const{tagName:u="DIV",namespaceURI:d=t,attributes:p,on:h,children:m}=o;delete o.tagName,delete o.namespaceURI,delete o.attributes,delete o.on,delete o.children,l||(l=d?document.createElementNS(d,u):document.createElement(u));const $=new c;l.addEventListener("removed",(()=>$.emit("*")),!1),b(o,l,$);for(const e in p){let t=p[e];if(!r(t)){if(s(t)){const o=t,c=()=>l.setAttribute(e,o());t=n(o,((t,n)=>{t.$$on(n,c),$.once(e,(()=>t.$$off(n,c)))}))}l.setAttribute(e,t)}}for(const e in h){const t=h[e];s(t)&&l.addEventListener(e,t)}let y=m;if(s(m)&&(y=n(m,((e,t,n)=>{if(f(e)&&"$each"===t&&s(n)){const o=(e,t,o)=>{const c=parseInt(t),r=n(e,c,o);if(r){const e=w(r,d);e&&l.appendChild(e)}};e.$$on("#add",o),$.once(t,(()=>e.$$off("#add",o)));const c=(e,t,o)=>{const c=parseInt(t),r=l.children[c],s=n(e,c,o);if(s){const e=w(s,d);e&&r&&l.replaceChild(e,r)}};e.$$on("#mod",c),$.once(t,(()=>e.$$off("#mod",c)));const r=(e,t,n)=>{const o=parseInt(t),c=l.children[o];c&&l.removeChild(c)};e.$$on("#del",r),$.once(t,(()=>e.$$off("#del",r)))}else{const n=m,o=()=>{const e=[].concat(n());l.innerHTML="";for(const t of e){const e=w(t,d);e&&l.appendChild(e)}};e.$$on(t,o),$.once(t,(()=>e.$$off(t,o)))}}))),!r(y)){const e=[].concat(y);for(const t of e){const e=w(t,d);e&&l.appendChild(e)}}return l}function b(e,t,o,c=0){const r=(e,t,n)=>{if("classList"===t&&f(n)&&!c){const e=[];for(const t of n)t&&e.push(t);n=e.join(" ")}a(n)?b(n,e[t],o,c+1):e[t]!==n&&(e[t]=n)};for(const c in e){let i=e[c];if(s(i)){const e=i,s=()=>r(t,c,e());i=n(e,((e,t)=>{e.$$on(t,s),o.once(c,(()=>e.$$off(t,s)))}))}r(t,c,i)}}e.createL10n=function(e){const{lang:t=navigator.language,fallback:n="en",locales:o={}}=e||{},c={lang:o[t]?t:n,fallback:n,locales:o,t:()=>s};Object.seal(c);const r=d(c);function s(e,t,n){i(t)&&(n=t,t=null);const o=r.locales||{};n||(n=r.$lang),o[n]||(n=r.fallback);let c=`${e}`.split(".").reduce(((e,t)=>a(e)?e[t]:""),o[n]);for(const e in t){const n=new RegExp(`%{${e}}`,"g");c=c.replace(n,t[e])}return c}return r},e.createRPC=function(e){const{url:t="/api/rpc",method:n="POST",headers:o={},credentials:c,mode:r,cache:s,redirect:i,referrer:f,referrerPolicy:l,priority:u}=e||{},d={};return Object.seal(d),new Proxy(d,{get:(e,d)=>async function(e){const p={};if(e instanceof File||e instanceof Blob){const t=new FormData;t.append("file",e),e=t}else a(e)?(p["Content-Type"]="application/json",e=JSON.stringify(e)):e=`${e}`;const h=await fetch(`${t}/${d}`,{method:n,credentials:c,mode:r,cache:s,redirect:i,referrer:f,referrerPolicy:l,priority:u,headers:Object.defineProperties(p,{...Object.getOwnPropertyDescriptors(o)}),body:e});if(!h.ok){const e=Error(h.statusText);throw e.code=h.statusCode,e}const m=h.headers.get("content-type");return/^application\/json/.test(m)?await h.json():/^application\/octet-stream/.test(m)?await h.blob():await h.text()}})},e.createRouter=function(e){function t(e,t){a(e)&&(t=e,e=null),location.hash=function(e,t){const n=[];for(const e in t)n.push(`${e}=${t[e]}`);let o=e?`#${e}`:"#";n.length&&(o+=`?${n.join("&")}`);return o}(e,t)}function n(){if((!location.hash||"#"===location.hash)&&r.home)return t(r.home);const{path:e,params:n}=function(e){const t={},n=/[?&]([^=]+)=([^&]*)/g;let o=n.exec(e);for(;o;)t[decodeURIComponent(o[1])]=decodeURIComponent(o[2]),o=n.exec(e);const c=/^#([^?]+)/.exec(e)||[],r=decodeURIComponent(c[1]||"");return{path:r,params:t}}(location.hash);r.params||(r.params={});for(const e in r.params)Object.prototype.hasOwnProperty.call(n,e)||delete r.params[e];for(const e in n)r.params[e]!==n[e]&&(r.params[e]=n[e]);r.path=e}const{home:o}=e||{},c={home:o,path:"",params:{},navigate:()=>t};Object.seal(c);const r=d(c);return n(),r.$$on("*",(()=>{t(r.path,r.params)})),window.addEventListener("hashchange",(()=>n())),r},e.createState=d,e.createSync=function(e,t,n){const{slippage:o}=n||{};let c;const r=async(...n)=>{const o=c,r=g(e),s=y(r,o);return c=await t(r,o,s,...n),a(c)&&m(e,c),c};let s;return"number"==typeof o?async function(...e){return new Promise((t=>{clearTimeout(s),s=setTimeout((async()=>t(await r(...e))),s?o:0)}))}:r},e.createView=function(e,t){const n=w(e),o=t||n,c=function(e){const t=new MutationObserver((function(e){const t=(e,n)=>{const o=e.children;for(let e=0;e<o.length;e++)t(o[e],n);const c=new Event(n);e.dispatchEvent(c)};for(const n of e)n.addedNodes.forEach((e=>{e.nodeType===Node.ELEMENT_NODE&&t(e,"mounted")})),n.removedNodes.forEach((e=>{e.nodeType===Node.ELEMENT_NODE&&t(e,"removed")}))}));return t.observe(e,{childList:!0,subtree:!0}),t}(o);return o.addEventListener("removed",(()=>c.disconnect()),!1),t&&n&&t.appendChild(n),n},e.deepClone=g,e.deepDiff=y,e.deepPatch=m,e.isEqual=$}));
