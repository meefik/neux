!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).neux={})}(this,(function(t){"use strict";function e(t){return void 0===t}function n(t){return"function"==typeof t}function o(t){return"string"==typeof t}function s(t){return Array.isArray(t)}function c(t){return"object"==typeof t&&null!==t&&(t.constructor===Object||t.constructor===Array)}const i=Symbol("context"),r={};function l(t){return c(t)?t:r}function f(t,e,n,o){const s=t[i];if(s){const t=s.get(e)||{};t[n]=o||null,s.set(e,t)}}function a(t,e,n){const o=new Map,s=t[i];t[i]=o;const c=e();s?t[i]=s:delete t[i];for(const t of o){const[e,o]=t;for(const t in o)n(e,t,o[t])}return c}class u extends Map{constructor(t){super(),this._ctx=t}on(t,e){if(t&&e){const n=[].concat(t);for(const t of n)this.has(t)||this.set(t,new Map),this.get(t).set(e,!1)}}once(t,e){if(t&&e){const n=[].concat(t);for(const t of n)this.has(t)||this.set(t,new Map),this.get(t).set(e,!0)}}off(t,e){if(t){const n=[].concat(t);for(const t of n)this.has(t)&&(e?(this.get(t).delete(e),this.get(t).size||this.delete(t)):(this.get(t).clear(),this.delete(t)))}}emit(t,...e){if(t){const n=[].concat(t);for(const t of n)if(this.has(t))for(const[n,o]of this.get(t)){o&&this.off(t,n);try{n.apply(this._ctx,e)}catch(t){console.error(t)}}}}}const d=Symbol("signal");function h(t){let e=0;if(o(t))for(;t.startsWith("$");)t=t.slice(1),e++;return[e>0&&(t||(e>1?"*":"#")),t]}function m(t,e,n,o,s){return s.emit(n),a(t,o=o.bind(t,e,n),((t,c)=>{const i=()=>{e[n]=o()};t.$$on(c,i),s.once(n,(()=>t.$$off(c,i)))}))}function p(t,e,n,o){if(o.emit(e),n[d]){const s=(n,o,s,c,i=[])=>{t.$$emit("*",n,o,s,c,[...i,e])};n.$$on("*",s),o.once(e,(()=>n.$$off("*",s)))}}function g(t,o){const s=l(this),c=n(t)?t.bind(s):()=>t,i=o?o.bind(s):()=>{},r=[],f=a(s,c,((t,l,f)=>{const a="#"===l&&n(f)?f.bind(s):null,u=a?(t,n,s,c)=>{const i=+s,r=e(t)?t:a(t,i,c);o(r,i,c)}:()=>{const t=c();i(t)};t.$$on(l,u),r.push((()=>t.$$off(l,u)))}));i(f);return()=>{for(const t of r)t()}}function w(t,i){const{document:r,Node:f,CustomEvent:a}=window,u=l(this);if(n(t)&&(t=t.call(u)),o(t))return r.createTextNode(t);if(!c(t))return t;if(s(t)){const e=r.createDocumentFragment();for(const n of t){const t=w.call(u,n,i);t instanceof f&&e.appendChild(t)}return e}const{tag:d,tagName:h="div",namespaceURI:m=i,shadowRootMode:p,adoptedStyleSheets:y,classList:b,attributes:v,style:$,dataset:E,on:L,children:N,ref:S,...x}=t,M=c(d)||n(d)?w.call(u,d,m):function(t,e){const{document:n,customElements:s,Element:c}=window,i=[];let r,l,f="div";if(o(t))if(/[^a-zA-Z0-9-_.#]/u.test(t)){const e=n.createElement("div");e.innerHTML=t,e.firstChild instanceof c&&(r=e.firstChild,f=r.tagName)}else{const e=t.match(/([.#]?[^\s#.]+)/gu)||[];for(const t of e){const e=t[0];"."===e?i.push(t.slice(1)):"#"===e?l=t.slice(1):f=t}}else t instanceof c&&(r=t,f=r.tagName);if(!r){const t=s?.get(f);if(t)r=new t;else{if("http://www.w3.org/1999/xhtml"===e&&(e=null),!e)switch(`${f}`.toLowerCase()){case"svg":e="http://www.w3.org/2000/svg";break;case"math":e="http://www.w3.org/1998/Math/MathML"}r=e?n.createElementNS(e,f):n.createElement(f)}}return l&&(r.id=l),i.length&&(r.className=i.join(" ")),r}(d||h,m);let C;i=M.namespaceURI,p&&(C=M.attachShadow({mode:p}),C&&y&&(C.adoptedStyleSheets=y));const A=[],P=(t,e)=>{if(n(t)){const n=g.call(u,t,e);A.push(n)}else e(t)};if(!e(L))for(const t in L){const e=L[t];n(e)&&M.addEventListener(t,(t=>e.call(u,t)))}const R=({children:t},e)=>{for(const n of t){const t=new a(e,{cancelable:!0});n.dispatchEvent(t)}};M.addEventListener("mounted",(t=>{t.defaultPrevented||R(M,"mounted")})),M.addEventListener("removed",(t=>{if(!t.defaultPrevented){R(M,"removed");for(const t of A)t()}})),e(b)||P(b,(t=>{Array.isArray(t)?M.classList=t.filter(Boolean).join(" "):o(t)&&(M.classList=t)})),e(v)||P(v,(t=>{for(const n in t)P(t[n],(t=>{e(t)?M.removeAttribute(n):M.setAttribute(n,t)}))})),e($)||P($,(t=>{for(const n in t)P(t[n],(t=>{/[A-Z]/u.test(n)?e(t)?delete M.style[n]:M.style[n]=t:e(t)?M.style.removeProperty(n):M.style.setProperty(n,t)}))})),e(E)||P(E,(t=>{for(const n in t)P(t[n],(t=>{e(t)?delete M.dataset[n]:M.dataset[n]=t}))}));for(const t in x)P(x[t],(n=>{e(n)?delete M[t]:M[t]=n}));if(!e(N)){const t=C||M;P(N,((n,o,s)=>{if(s)if(e(n)){const e=t.children[o];e&&t.removeChild(e)}else if(t.children[o]){const e=t.children[o];if(e){const o=w.call(u,n,i);o&&t.replaceChild(o,e)}}else{const e=w.call(u,n,i);e&&t.appendChild(e)}else{t.innerHTML="";const e=w.call(u,n,i);e instanceof f&&t.appendChild(e)}}))}return n(S)&&S.call(u,M),M}t.effect=g,t.l10n=function(t,i){const{language:r=navigator.language,fallback:l="en"}=i||{},f=(e,n)=>{const o=t[n]||{};return e in o?o[e]:e.split(".").reduce(((t,e)=>c(t)?t[e]:""),o)};return(c,i,a=r)=>{if(o(i)&&(a=i,i=null),a&&t[a]||(a=l),o(c)){let t=f(c,a);return a!==l&&e(t)&&(t=f(c,l)),((t,e,c)=>{if(o(t))for(const o in e){const i=new RegExp(`%\\{${o}\\}`,"gu");let r=e[o];if(s(r)){const[t,e]=r;r=n(t?.toLocaleString)?t.toLocaleString(c,e):t}t=t.replace(i,r)}return t})(e(t)?c:t,i,a)}return n(c?.toLocaleString)?c.toLocaleString(a,i):c}},t.mount=function(t,e){const{MutationObserver:n,CustomEvent:s,Element:c,document:i}=window,{ELEMENT_NODE:r}=c,l=(t,e)=>{if(t.nodeType!==r)return;const n=new s(e,{cancelable:!0});t.dispatchEvent(n)};o(e)&&(e=i.querySelector(e));const f=new n((e=>{for(const n of e)if("childList"===n.type)n.addedNodes.forEach((t=>{t.parentNode&&l(t,"mounted")})),n.removedNodes.forEach((e=>{e.parentNode||l(e,"removed"),e===t&&f.disconnect()}));else if("attributes"===n.type){const t=n.target,{attributeName:e}=n,{oldValue:o}=n,c=t.getAttribute(e);if(o!==c){const n=new s("changed",{detail:{attributeName:e,oldValue:o,newValue:c}});t.dispatchEvent(n)}}}));f.observe(e,{childList:!0,subtree:!0,attributeOldValue:!0}),e.appendChild(t)},t.render=function(t,e,n){return s(t)?w.call(this,t):(c(t)&&(n=e,e=t,t=null),c(e)&&!s(e)||(n=e,e={}),w.call(this,{tag:t,children:n,...e}))},t.signal=function t(e={}){if(!c(e)||e[d])return e;const o=l(this),i=new u(o),r=new u,a=new u,g={$$on:(t,e)=>i.on(t,e),$$once:(t,e)=>i.once(t,e),$$off:(t,e)=>i.off(t,e),$$emit:(t,...e)=>i.emit(t,...e)},w=new Proxy(e,{get:(t,e)=>{if(e===d)return!0;if(e in g)return g[e];const[n,c]=h(e);if(n){if("map"===c&&s(t))return(t,e=o)=>(f(o,w,"#",t.bind(e)),w.map(t,e));if(f(o,w,n),!c)return w}return Reflect.get(t,c)},set:(e,l,f)=>{const[u]=h(l);if(u)return!1;const d=e[l];if(n(f)){f=m(o,w,l,f,a)}c(f)&&(f=t.call(o,f),p(w,l,f,r));const g="length"===l&&s(e),y=e[l]!==f||g;return!!Reflect.set(e,l,f)&&(y&&i.emit(g?l:[l,"#","*"],f,d,l,w),!0)},deleteProperty:(t,e)=>{const[n]=h(e);if(n)return!1;const o=t[e];return!!Reflect.deleteProperty(t,e)&&(r.emit(e),a.emit(e),i.emit([e,"#","*"],void 0,o,e,w),!0)}}),y=Object.keys(e);for(const s of y){const[i]=h(s);if(!i){if(n(e[s])){const t=e[s];e[s]=m(o,w,s,t,a)}if(c(e[s])){const n=t.call(o,e[s]);e[s]=n,p(w,s,n,r)}}}return w}}));
