!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).NEUX={})}(this,(function(e){"use strict";function t(e){return void 0===e}function n(e){return"function"==typeof e}function o(e){return"string"==typeof e}function s(e){return Array.isArray(e)}function i(e){return"object"==typeof e&&null!==e&&(e.constructor===Object||e.constructor===Array)}class c{#e={};#t;constructor(e){this.#t=e}on(e,t){if(e&&t){const n=this.#e,o=[].concat(e);for(const e of o)n[e]||(n[e]=new Map),n[e].set(t,!1)}}once(e,t){if(e&&t){const n=this.#e,o=[].concat(e);for(const e of o)n[e]||(n[e]=new Map),n[e].set(t,!0)}}off(e,t){if(e){const n=this.#e,o=[].concat(e);for(const e of o)n[e]&&(t?(n[e].delete(t),n[e].size||delete n[e]):(n[e].clear(),delete n[e]))}else this.#e={}}emit(e,...t){const n=this.#e;if("*"===e)for(const e in n)for(const[o,s]of n[e])o.apply(this.#t,t),s&&this.off(e,o);else{const o=new Set([].concat(e));for(const e of o)if(n[e])for(const[o,s]of n[e])o.apply(this.#t,t),s&&this.off(e,o)}}}const r=Symbol("state"),a=Symbol("context"),l=/^\$[^$]/u,f={};function u(e,t,n,o){const s=e[a];if(s){const e=s.get(t)||{};e[n]=o||null,s.set(t,e)}}function d(e,n,o,s,i){return i.emit(o),function(e,t,n){if(e[a])throw Error("Collision in state binding");const o=new Map;e[a]=o;const s=t();delete e[a];for(const e of o){const[t,o]=e;for(const e in o)n(t,e,o[e])}return s}(e,(()=>s.call(e,n,o)),((c,r,a)=>{const l=a?(s,i,c,r)=>{const l=n[o],f=parseInt(c,10);if(t(s))l.splice(f,1);else if(t(i)){const t=a.call(e,s,f,r);l[f]=t}else{const t=a.call(e,s,f,r);l.splice(f,1,t)}}:()=>{const t=s.call(e,n,o);n[o]=t};c.$$on(r,l),i.once(o,(()=>c.$$off(r,l)))}))}function p(e,t,n,o){if(o.emit(t),n[r]){const s=(n,o,s,i,c=[])=>{e.$$emit([t,"*"],n,o,s,i,[...c,t])};n.$$on("*",s),o.once(t,(()=>n.$$off("*",s)))}}function h(e){if(!i(e))return e;const t=s(e)?[]:{};for(const n in e)t[n]=h(e[n]);return t}function $(e,n,o){const c=s(n);for(const r in e)if(i(e[r]))if(i(n[r]))$(e[r],n[r],o);else{const t=v(s(e[r])?[]:{},o);$(e[r],t,o),c?n.splice(parseInt(r,10),1,t):n[r]=t}else t(e[r])||(c?n.splice(parseInt(r,10),1,e[r]):n[r]=e[r]);if(c){const t=s(e)?e.length:0,o=n.length-t;o>0&&n.splice(t,o)}else for(const o in n)e&&!t(e[o])||delete n[o]}function m(e,n){if(i(e)&&i(n)){for(const o in n)if(t(e[o]))return!1;for(const t in e)if(!m(e[t],n[t]))return!1}else if(e!==n)return!1;return!0}function g(e,t){let n=!0;for(const o in t)if(e[o]!==t[o]){n=!1;break}return n}function y(e,n){if(g(e,n))return e;for(const o in e){const c=e[o];if(i(c)||s(c)){const e=y(c,n);if(!t(e))return e}}}function w(e,t,n=[]){g(e,t)&&n.push(e);for(const o in e){const c=e[o];(i(c)||s(c))&&w(c,t,n)}return n}function v(e,a){if(t(e))e={};else if(!i(e)||e[r])return e;const{context:g=f}=a||{},b=new c(g),x=new c,T=new c,E=new Proxy(e,{get:(e,t)=>t===r||(o(t)&&l.test(t)&&(n(e[t=t.slice(1)])||u(g,E,t)),Reflect.get(e,t)),set:(e,t,o)=>{const c=h(e[t]);if(n(o)){o=d(g,E,t,o,x)}i(o)&&(o=v(o,a),p(E,t,o,T));const r=e[t]!==o||"length"===t&&s(e);if(!Reflect.set(e,t,o))return!1;if(r){const n=[t];s(e)&&isNaN(t)||n.push("*"),s(e)&&!isNaN(t)&&n.push("#"),b.emit(n,o,c,t,E)}return!0},deleteProperty:(e,t)=>{const n=h(e[t]);if(!Reflect.deleteProperty(e,t))return!1;x.emit(t),T.emit(t);const o=[t];return s(e)&&isNaN(t)||o.push("*"),s(e)&&!isNaN(t)&&o.push("#"),b.emit(o,void 0,n,t,E),!0}}),D={configurable:!1,enumerable:!1,writable:!1};Object.defineProperties(E,{$:{...D,value:e=>E[`$${e}`]},$$on:{...D,value:(...e)=>b.on(...e)},$$once:{...D,value:(...e)=>b.once(...e)},$$off:{...D,value:(...e)=>b.off(...e)},$$emit:{...D,value:(...e)=>b.emit(...e)},$$query:{...D,value:e=>y(E,e)},$$queryAll:{...D,value:e=>w(E,e)},$$create:{...D,value:e=>v(e,a)},$$clone:{...D,value:(e=E)=>h(e)},$$equal:{...D,value:(e,t=E)=>m(e,t)},$$patch:{...D,value:(e,t=E)=>$(e,t,a)},$$each:{...D,value(e,t){if(s(E))return n(e)&&u(g,E,"#",e.bind(t)),E.map(e,t).filter((e=>e))}}});for(const t in e){if(n(e[t])){const n=e[t],o=d(g,E,t,n,x);e[t]=o}if(i(e[t])){const n=v(e[t],a);e[t]=n,p(E,t,n,T)}}return E}function b(e,t){i(e)||(e={});const{document:n,Element:s}=window,{tagName:c="div",namespaceURI:r,node:a}=e;r?t=r:"svg"===c?t="http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml"===t&&(t=null);let l=a instanceof s?a:t?n.createElementNS(t,c):n.createElement(c);o(a)&&(l.innerHTML=a,l.firstChild instanceof s&&(l=l.firstChild));const f={configurable:!1,enumerable:!0,writable:!1};Object.defineProperties(e,{tagName:{...f,value:c},namespaceURI:{...f,value:t},node:{...f,value:l}});for(const t in e){x(l,e[t],void 0,t)}return l}function x(e,o,c,r,a,l=[]){const{Element:f}=window,[u]=l;let d=0;for(let t=l.length-1,n=e;t>=0;t--){if(n=n[l[t]],!n)break;n instanceof f?(e=n,d=0):d++}if(0===d)if("on"===r){for(const t in o){const s=o[t];n(s)&&e.addEventListener(t,s)}for(const s in c)if(!o||t(o[s])){const t=c[s];n(t)&&e.removeEventListener(s,t)}}else if("attributes"===r){for(const n in o){const s=o[n];t(s)||e.setAttribute(n,s)}for(const n in c)o&&!t(o[n])||e.removeAttribute(n)}else if("style"===r){const{style:n}=e;for(const e in o)n[e]=o[e];for(const e in c)o&&!t(o[e])||n.removeProperty(e)}else if("classList"===r)e.classList=s(o)?o.join(" "):o||"";else if("children"===r){if(e.innerHTML="",s(o))for(const t of o){const n=b(t,e.namespaceURI);n&&e.appendChild(n)}}else if(i(o)){if(e[r]){for(const n in o){const s=o[n];t(s)||(e[r][n]=s)}for(const n in c)t(o[n])&&delete e[r][n]}}else t(o)?delete e[r]:function(e){return["tagName","namespaceURI","node"].includes(e)}(r)||t(e[r])||(e[r]=o);else if(1===d)if("on"===u)t(o)?n(c)&&e.removeEventListener(r,c):n(o)&&e.addEventListener(r,o);else if("attributes"===u)t(o)?e.removeAttribute(r):e.setAttribute(r,o);else if("style"===u){const{style:n}=e;t(o)?n.removeProperty(r):/[A-Z]/u.test(r)?n[r]=o:n.setProperty(r,o)}else if("classList"===u)e.classList=s(a)?a.join(" "):a||"";else if("children"===u)if(t(o)){const t=e.children[r];t&&e.removeChild(t)}else if(t(c)){const t=b(o,e.namespaceURI);t&&e.appendChild(t)}else{const t=e.children[r],n=b(o,e.namespaceURI);n&&t&&e.replaceChild(n,t)}else e[u]&&(t(o)?delete e[u][r]:e[u][r]=o)}function T(e,t){const n=-1*new Date(e).getTimezoneOffset();return`${n>=0?"+":""}${t?""+~~(n/60):("0"+~~(n/60)).slice(-2)}:${("0"+~~(n%60)).slice(-2)}`}function E(e){const t={},n=/[?&](?<key>[^=]+)=(?<val>[^&]*)/gu;let o=n.exec(e);const{decodeURIComponent:s}=window;for(;o;){t[s(o.groups.key)]=s(o.groups.val),o=n.exec(e)}const i=/^#(?<path>[^?]+)/u.exec(e);return{path:s(i?.groups.path||""),query:t}}function D(e,t){const{location:n}=window;if(i(e)&&(t=e,e=null),!o(e)){const{path:t}=E(n.hash);e=t}n.hash=function(e,t){const n=[];for(const e in t)n.push(`${e}=${t[e]}`);let o=e?`#${e}`:"#";return n.length&&(o+=`?${n.join("&")}`),o}(e,t)}e.createL10n=function(e,t){const{lang:n=navigator.language,fallback:s="en",prefix:c,context:r}=t||{},a=(t,n,c)=>{if(o(n)&&(c=n,n=null),c||(c=f.$lang),c&&e[c]||(c=s),!c)return t;let r=`${t}`.split(".").reduce(((e,t)=>i(e)?e[t]:""),e[c]);for(const e in n){const t=new RegExp(`%\\{${e}\\}`,"gu");r=r.replace(t,n[e])}return r},l=(e,t,n)=>{const o=c?`${c}.`:"";e=new Date(e);const s=()=>n?e.getUTCFullYear():e.getFullYear(),i=()=>n?e.getUTCMonth():e.getMonth(),r=()=>n?e.getUTCDate():e.getDate(),l=()=>n?e.getUTCDay():e.getDay(),f=()=>n?e.getUTCHours():e.getHours(),u=()=>n?e.getUTCMinutes():e.getMinutes(),d=()=>n?e.getUTCSeconds():e.getSeconds(),p=()=>{const e=n?Date.UTC(s(),0,0):new Date(s(),0,0).getTime(),t=n?Date.UTC(s(),i(),r()):new Date(s(),i(),r()).getTime();return Math.round((t-e)/864e5)},h={YYYY:()=>`000${s()}`.slice(-4),YY:()=>`0${s()}`.slice(-2),Q:()=>`${Math.ceil((i()+1)/3)}`,MMMM:()=>a(`${o}month.full.${i()}`),MMM:()=>a(`${o}month.short.${i()}`),MM:()=>`0${i()+1}`.slice(-2),M:()=>`${i()+1}`,DD:()=>`0${r()}`.slice(-2),D:()=>`${r()}`,DDDD:()=>`00${p()}`.slice(-3),DDD:()=>`${p()}`,dddd:()=>a(`${o}day.full.${l()}`),ddd:()=>a(`${o}day.short.${l()}`),HH:()=>`0${f()}`.slice(-2),H:()=>`${f()}`,hh:()=>`0${f()>12?f()-12:f()||12}`.slice(-2),h:()=>`${f()>12?f()-12:f()||12}`,kk:()=>`0${f()+1}`.slice(-2),k:()=>`${f()+1}`,mm:()=>`0${u()}`.slice(-2),m:()=>`${u()}`,ss:()=>`0${d()}`.slice(-2),s:()=>`${d()}`,X:()=>""+e.getTime()/1e3,x:()=>`${e.getTime()}`,a:()=>a(f()<12?`${o}time.am.0`:`${o}time.pm.0`),A:()=>f()<12?a(`${o}time.am.1`):a(`${o}time.pm.1`),ZZ:()=>n?"+00:00":T(e),Z:()=>n?"+0:00":T(e,!0)};for(const e in h){const n=new RegExp(`\\{${e}\\}`,"gu");t=t.replace(n,h[e])}return t},f=v({lang:e[n]?n:s,locales:Object.keys(e),t:()=>a,d:()=>l,translate:()=>a,dateToLocaleString:()=>l},{context:r});return Object.seal(f),f},e.createRPC=function(e){const{url:t="/api/rpc",method:n="POST",headers:o={},mode:c,credentials:r}=e,a={};return Object.seal(a),new Proxy(a,{get:(e,a)=>async function(e){const l={};if(e instanceof FormData);else if(e instanceof File||e instanceof Blob){const t=new FormData;t.append("file",e),e=t}else i(e)||s(e)?(l["Content-Type"]="application/json",e=JSON.stringify(e)):e=`${e}`;const f=await fetch(`${t}/${a}`,{method:n,mode:c,credentials:r,headers:Object.defineProperties(l,{...Object.getOwnPropertyDescriptors(o)}),body:e});if(!f.ok)throw Error(f.statusText);const u=f.headers.get("content-type")||"";return/^application\/json/u.test(u)?await f.json():/^application\/octet-stream/u.test(u)?await f.blob():await f.text()}})},e.createRouter=function(e,n){const{home:o,context:s}=n||{},{location:i,addEventListener:c}=window,r=v({path:"",params:{},query:{},navigate:()=>D},{context:s});Object.seal(r);const a=()=>{if(i.hash&&"#"!==i.hash||!o){const{path:n,query:o}=E(i.hash);r.query||(r.query={});for(const e in r.query)t(o)&&delete r.query[e];for(const e in o)r.query[e]!==o[e]&&(r.query[e]=o[e]);for(const t in e){const o=e[t],s=n.match(o);r.params[t]=s&&s[1]}r.path=n}else i.hash=o};return a(),r.$$on("*",(()=>{D(r.path,r.query)})),c("hashchange",(()=>a())),r},e.createState=v,e.createSync=function(e,t,n){const{slippage:o}=n||{};let s=null;const c=async(...n)=>{const o=s,c=e.$$clone(),r=await t(c,o,...n);return i(r)&&e.$$patch(r),s=r};let r=null;return"number"==typeof o?(...e)=>new Promise((t=>{clearTimeout(r),r=setTimeout((async()=>t(await c(...e))),r?o:0)})):c},e.createView=function(e,t){const{target:n,context:o}=t||{},s=v(e,{context:o}),i=b(s);s.$$on("*",((...e)=>{x(i,...e)}));const c=function(e){const{MutationObserver:t,CustomEvent:n,Element:o}=window,{ELEMENT_NODE:s}=o,i=new t((e=>{const t=(e,o)=>{const{children:s}=e;for(let e=0;e<s.length;e++)t(s[e],o);const i=new n(o);e.dispatchEvent(i)};for(const o of e)if("childList"===o.type)o.addedNodes.forEach((e=>{e.nodeType===s&&t(e,"mounted")})),o.removedNodes.forEach((e=>{e.nodeType===s&&t(e,"removed")}));else if("attributes"===o.type){const e=o.target,{attributeName:t}=o,{oldValue:s}=o,i=e.getAttribute(t);if(s!==i){const o=new n("changed",{detail:{attributeName:t,oldValue:s,newValue:i}});e.dispatchEvent(o)}}}));return i.observe(e,{childList:!0,subtree:!0,attributeOldValue:!0}),i}(n||i);return i.addEventListener("removed",(e=>{e.target===i&&c.disconnect()}),!1),n&&n.appendChild(i),s}}));
