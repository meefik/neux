!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).neux={})}(this,(function(t){"use strict";function e(t){return void 0===t}function n(t){return"function"==typeof t}function o(t){return"string"==typeof t}function s(t){return Array.isArray(t)}function i(t){return"object"==typeof t&&null!==t&&(t.constructor===Object||t.constructor===Array)}function c(t){return t instanceof Date}function r(t){if(!i(t))return t;const e=s(t)?[]:{};for(const n in t)e[n]=r(t[n]);return e}const l=Symbol("context"),f={};function a(t){return i(t)?t:f}function u(t,e,n,o){const s=t[l];if(s){const t=s.get(e)||{};t[n]=o||null,s.set(e,t)}}function d(t,e,n){if(t[l])throw Error("Collision in signal binding");const o=new Map;t[l]=o;const s=e();delete t[l];for(const t of o){const[e,o]=t;for(const t in o)n(e,t,o[t])}return s}class h{constructor(t){this._list={},this._context=t}on(t,e,n){if(t&&e){const o=this._list,s=[].concat(t);for(const t of s)o[t]||(o[t]=new Map),o[t].set(e,n)}}off(t,e){if(t){const n=this._list,o=[].concat(t);for(const t of o)n[t]&&(e?(n[t].delete(e),n[t].size||delete n[t]):(n[t].clear(),delete n[t]))}else this._list={}}emit(t,...e){const o=this._list,s="*"===t?Object.keys(o):[].concat(t);for(const t of s)if(o[t])for(const[s,i]of o[t])try{s.apply(this._context,e),(n(i)?i():i)&&this.off(t,s)}catch(t){console.error(t)}}}const p=Symbol("signal"),m=/^\$([^$]|$)/u;function g(t,o,s,i,c){c.emit(s),i=i.bind(t,o,s);return d(t,i,((r,l,f)=>{const a=(f=n(f)?f.bind(t):null)?(t,n,i,c)=>{const r=o[s],l=parseInt(i,10);if(e(t))r.splice(l,1);else if(e(n)){const e=f(t,l,c);r[l]=e}else{const e=f(t,l,c);r.splice(l,1,e)}}:()=>{o[s]=i()};r.$$on(l,a),c.on(s,(()=>r.$$off(l,a)),!0)}))}function w(t,e,n,o){if(o.emit(e),n[p]){const s=(n,o,s,i,c=[])=>{t.$$emit([e,"*"],n,o,s,i,[...c,e])};n.$$on("*",s),o.on(e,(()=>n.$$off("*",s)),!0)}}function y(t,o,s){const i=a(this);t=t.bind(i),o=o?o.bind(i):()=>{};const c=[],r=d(i,t,((r,l,f)=>{const a=(f=n(f)?f.bind(i):null)?(t,n,s,i)=>{const c=+s;if(e(t))o(void 0,c,"del");else if(e(n)){const e=f(t,c,i);o(e,c,"add")}else{const e=f(t,c,i);o(e,c,"upd")}}:(...e)=>{o(t(...e))};r.$$on(l,a,s),c.push((()=>r.$$off(l,a)))}));return o(r),()=>{for(const t of c)t()}}function $(t,c){const{document:r,Node:l}=window,f=a(this);if(n(t)&&(t=t.call(f)),o(t))return r.createTextNode(t);if(!i(t))return t;if(s(t)){const e=r.createDocumentFragment();for(const n of t){const t=$.call(f,n,c);t instanceof l&&e.appendChild(t)}return e}const{tag:u,tagName:d="div",namespaceURI:h=c,shadowRootMode:p,adoptedStyleSheets:m,classList:g,attributes:w,style:b,dataset:v,on:E,children:N,ref:L,...C}=t,x=function(t,e){const{document:n,customElements:s,Element:i}=window,c=[];let r,l,f="div";if(o(t))if(/[^a-zA-Z0-9-_.#]/u.test(t)){const e=n.createElement("div");e.innerHTML=t,e.firstChild instanceof i&&(r=e.firstChild,f=r.tagName)}else{const e=t.match(/([.#]?[^\s#.]+)/gu)||[];for(const t of e){const e=t[0];"."===e?c.push(t.slice(1)):"#"===e?l=t.slice(1):f=t}}else t instanceof i&&(r=t,f=r.tagName);if(!r){const t=s?.get(f);if(t)r=new t;else{if("http://www.w3.org/1999/xhtml"===e&&(e=null),!e)switch(`${f}`.toLowerCase()){case"svg":e="http://www.w3.org/2000/svg";break;case"math":e="http://www.w3.org/1998/Math/MathML"}r=e?n.createElementNS(e,f):n.createElement(f)}}return l&&(r.id=l),c.length&&(r.className=c.join(" ")),r}(u??d,h);let A;c=x.namespaceURI,p&&(A=x.attachShadow({mode:p}),A&&m&&(A.adoptedStyleSheets=m));const M=[],S=(t,e)=>{if(n(t)){const n=y.call(f,t,e);M.push(n)}else e(t)};if(!e(E))for(const t in E){const e=E[t];n(e)&&x.addEventListener(t,(t=>e.call(f,t)))}const _=({children:t},e)=>{for(const n of t){const t=new CustomEvent(e,{cancelable:!0});n.dispatchEvent(t)}};x.addEventListener("mounted",(t=>{t.defaultPrevented||_(x,"mounted")})),x.addEventListener("removed",(t=>{if(!t.defaultPrevented){_(x,"removed");for(const t of M)t()}})),e(g)||S(g,(t=>{Array.isArray(t)?x.classList=t.join(" "):o(t)&&(x.classList=t)})),e(w)||S(w,(t=>{for(const n in t)S(t[n],(t=>{e(t)?x.removeAttribute(n):x.setAttribute(n,t)}))})),e(b)||S(b,(t=>{for(const n in t)S(t[n],(t=>{/[A-Z]/u.test(n)?e(t)?delete x.style[n]:x.style[n]=t:e(t)?x.style.removeProperty(n):x.style.setProperty(n,t)}))})),e(v)||S(v,(t=>{for(const n in t)S(t[n],(t=>{e(t)?delete x.dataset[n]:x.dataset[n]=t}))}));for(const t in C)S(C[t],(n=>{e(n)?delete x[t]:x[t]=n}));if(!e(N)){const t=A||x;S(N,((e,n,o)=>{if("del"===o){const e=t.children[n];e&&t.removeChild(e)}else if("add"===o){const n=$.call(f,e,c);n&&t.appendChild(n)}else if("upd"===o){const o=t.children[n];if(o){const n=$.call(f,e,c);n&&t.replaceChild(n,o)}}else{t.innerHTML="";const n=$.call(f,e,c);n instanceof l&&t.appendChild(n)}}))}return n(L)&&L.call(f,x),x}t.effect=y,t.l10n=function(t,e){const{language:n=navigator.language,fallback:r="en"}=e||{};return(e,l,f=n)=>{o(l)&&(f=l,l=null),f&&t[f]||(f=r);let a=`${e}`.split(".").reduce(((t,e)=>i(t)?t[e]:""),t[f]);if(o(a))for(const t in l){const e=new RegExp(`%\\{${t}\\}`,"gu");let n=l[t];if(s(n)){const[t,e]=n;n=t,i(e)&&("number"==typeof t||c(t))&&(n=t.toLocaleString(f,e))}a=a.replace(e,n)}return a}},t.mount=function(t,e){const{MutationObserver:n,CustomEvent:s,Element:i,document:c}=window,{ELEMENT_NODE:r}=i,l=(t,e)=>{if(t.nodeType!==r)return;const n=new s(e,{cancelable:!0});t.dispatchEvent(n)};o(e)&&(e=c.querySelector(e));const f=new n((e=>{for(const n of e)if("childList"===n.type)n.addedNodes.forEach((t=>{l(t,"mounted")})),n.removedNodes.forEach((e=>{l(e,"removed"),e===t&&f.disconnect()}));else if("attributes"===n.type){const t=n.target,{attributeName:e}=n,{oldValue:o}=n,i=t.getAttribute(e);if(o!==i){const n=new s("changed",{detail:{attributeName:e,oldValue:o,newValue:i}});t.dispatchEvent(n)}}}));f.observe(e,{childList:!0,subtree:!0,attributeOldValue:!0}),e.appendChild(t)},t.render=function(t,e,n){return s(t)?$.call(this,t):(i(t)&&(n=e,e=t,t=null),i(e)&&!s(e)||(n=e,e={}),$.call(this,{tag:t,children:n,...e}))},t.signal=function t(e={}){if(!i(e)||e[p])return e;const c=a(this),l=new h(c),f=new h,d=new h,y={$:t=>$["$"+t],$$on:(t,e)=>l.on(t,e),$$once:(t,e)=>l.on(t,e,!0),$$off:(t,e)=>l.off(t,e),$$emit:(t,...e)=>l.emit(t,...e),$$map(t,e=c){if(s($))return n(t)&&u(c,$,"#",t.bind(e)),$.map(t,e)}},$=new Proxy(e,{get:(t,e)=>e===p||(e in y?y[e]:(o(e)&&m.test(e)&&(n(t[e=e.slice(1)])||u(c,$,e)),Reflect.get(t,e))),set:(e,a,u)=>{if(o(a)&&m.test(a)){const t=a.slice(1)||"*";return n(u)&&l.on(t,u),!0}const h=r(e[a]);if(n(u)){u=g(c,$,a,u,d)}i(u)&&(u=t.call(c,u),w($,a,u,f));const p=e[a]!==u||"length"===a&&s(e);if(!Reflect.set(e,a,u))return!1;if(p){const t=[a];s(e)&&isNaN(a)||t.push("*"),s(e)&&!isNaN(a)&&t.push("#"),l.emit(t,u,h,a,$)}return!0},deleteProperty:(t,e)=>{if(o(e)&&m.test(e)){const t=e.slice(1)||"*";return l.off(t),!0}const n=r(t[e]);if(!Reflect.deleteProperty(t,e))return!1;f.emit(e),d.emit(e);const i=[e];return s(t)&&isNaN(e)||i.push("*"),s(t)&&!isNaN(e)&&i.push("#"),l.emit(i,void 0,n,e,$),!0}});for(const s in e){if(n(e[s])){const t=e[s];if(o(s)&&m.test(s)){const n=s.slice(1)||"*";l.on(n,t),delete e[s]}else e[s]=g(c,$,s,t,d)}if(i(e[s])){const n=t.call(c,e[s]);e[s]=n,w($,s,n,f)}}return $}}));
