!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).NEUX={})}(this,(function(t){"use strict";class e{_list={};on(t,e){if(t&&e){const n=this._list,o=[].concat(t);for(const t of o)n[t]||(n[t]=new Map),n[t].set(e,!1)}}once(t,e){if(t&&e){const n=this._list,o=[].concat(t);for(const t of o)n[t]||(n[t]=new Map),n[t].set(e,!0)}}off(t,e){if(t){const n=this._list,o=[].concat(t);for(const t of o)n[t]&&(e?(n[t].delete(e),n[t].size||delete n[t]):(n[t].clear(),delete n[t]))}}emit(t,...e){const n=this._list;if("*"===t)for(const t in n)for(const[o,c]of n[t])o(...e),c&&this.off(t,o);else{const o=new Set([].concat(t));for(const t of o)if(n[t])for(const[o,c]of n[t])o(...e),c&&this.off(t,o)}}}function n(t){return void 0===t}function o(t){return"function"==typeof t}function c(t){return"string"==typeof t}function i(t){return Array.isArray(t)}function r(t){return"object"==typeof t&&null!==t&&(t.constructor===Object||t.constructor===Array)}function s(t,e){return r(t)&&Object.prototype.hasOwnProperty.call(t,e)}const a=Symbol("isProxy"),f=/^\$/,u={};function l(t,s=u){if(n(t))t={};else if(!r(t)||t[a])return t;const w=new e,g=new e,b=new e,v=new Proxy(t,{get:(t,e,n)=>e===a||("$"===e?function(t){return n["$"+t]}:"$$on"===e?function(...t){return w.on(...t)}:"$$once"===e?function(...t){return w.once(...t)}:"$$off"===e?function(...t){return w.off(...t)}:"$$emit"===e?function(...t){return w.emit(...t)}:"$$watch"===e?function(t,e,o){return h(s,n,t,e,o,g)}:"$$unwatch"===e?function(t="*"){g.emit(t)}:"$$clone"===e?function(e=t){return $(e)}:"$$equal"===e?function(e,n=t){return y(e,n)}:"$$patch"===e?function(t,e=n){return m(s,t,e)}:"$$each"===e&&i(t)?function(e,c){return o(e)&&d(s,n,"#",e),t.map(e,c).filter((t=>t))}:(c(e)&&f.test(e)&&(e=e.slice(1),o(t[e])||d(s,n,e)),Reflect.get(t,e))),set:(t,e,n,c)=>{const a=$(t[e]);if(o(n)){n=h(s,c,e,n,(t=>t),g)}r(n)&&(n=l(n,s),p(c,e,n,b));const f=i(t)&&"length"===e||t[e]!==n;if(!Reflect.set(t,e,n))return!1;if(f){const o=[e,"*"];i(t)&&!isNaN(e)&&o.push("#");(async()=>{w.emit(o,n,a,e,c)})()}return!0},deleteProperty:(t,e,n)=>{const o=$(t[e]);if(!Reflect.deleteProperty(t,e))return!1;g.emit(e),b.emit(e);const c=[e,"*"];i(t)&&!isNaN(e)&&c.push("#");return(async()=>{w.emit(c,void 0,o,e,n)})(),!0}});for(const e in t){if(o(t[e])){const n=t[e],o=t=>t;t[e]=h(s,v,e,n,o,g)}if(r(t[e])){const n=l(t[e],s);t[e]=n,p(v,e,n,b)}}return v}function d(t,e,n,o){const c=t.value;if(!c)return;const i=c.get(e)||{};i[n]=o||null,c.set(e,i)}function h(t,e,c,i,r,s){let a=function(t,e,n){if(t.value)throw Error("Collision in state binding");const o=t.value=new Map,c=e();delete t.value;for(const t of o){const[e,o]=t;for(const t in o)n(e,t,o[t])}return c}(t,(()=>i(e,c)),((t,f,u)=>{let l;l=u?(t,i,s,a)=>{if(!isNaN(s))if(s=parseInt(s),n(i)||(i=u(i,s,a)),n(t)||(t=u(t,s,a)),o(r)){n(r(t,i,s,a))||(e[c]=a)}else e.$$emit(c,t,i,s,a)}:()=>{const t=i(e,c);if(o(r)){const o=r(t,a,c,e);n(o)||(e[c]=o)}else e.$$emit(c,t,a,c,e);a=t},t.$$on(f,l),s.once(c,(()=>t.$$off(f,l)))}));return a}function p(t,e,n,o){if(o.emit(e),!n[a])return;const c=(...n)=>{t.$$emit(["*"],...n,e)};n.$$on("*",c),o.once(e,(()=>n.$$off("*",c)))}function $(t){if(!r(t))return t;const e=i(t)?[]:{};for(const n in t)e[n]=$(t[n]);return e}function m(t,e,o){const c=i(o);for(const s in e)if(r(e[s]))if(r(o[s]))m(t,e[s],o[s]);else{const n=l(i(e[s])?[]:{},t);m(t,e[s],n),c?o.splice(parseInt(s),1,n):o[s]=n}else n(e[s])||(c?o.splice(parseInt(s),1,e[s]):o[s]=e[s]);if(c){const t=i(e)?e.length:0,n=o.length-t;n>0&&o.splice(t,n)}else for(const t in o)s(e,t)||delete o[t]}function y(t,e){if(r(t)&&r(e)){for(const n in e)if(!s(t,n))return!1;for(const n in t)if(!y(t[n],e[n]))return!1}else if(t!==e)return!1;return!0}function w(t,e,s){if(!r(t))return;let a;if((t={...t}).view){if(a=t.view,delete t.view,o(a))return w(a(t),e,s);if(c(a)){const n=document.createElement("div");return n.innerHTML=a,t.view=n.firstChild,w(t,e,s)}}s||"SVG"!==`${t.tagName}`.toUpperCase()||(s="http://www.w3.org/2000/svg");const{tagName:f="DIV",namespaceURI:u=s,attributes:d,classList:h,on:p,children:$}=t;delete t.tagName,delete t.namespaceURI,delete t.attributes,delete t.classList,delete t.on,delete t.children,a||(a=u?document.createElementNS(u,f):document.createElement(f));const m=l({},e);a.addEventListener("removed",(()=>{delete m["*"]}),!1);for(const t in p){const e=p[t];o(e)&&a.addEventListener(t,e)}for(const t in d){const e=d[t],n=e=>{a.setAttribute(t,e)};if(o(e)){const o=e;n(m.$$watch(`attributes.${t}`,o,n))}else n(e)}if(!n(h)){const t=t=>{i(t)&&(t=t.join(" ")),a.classList=t};if(o(h)){const e=h;t(m.$$watch("classList",e,t))}else t(h)}if(g(m,a,t),!n($)){const t="children",c=(o,c,i)=>{if(i===t){if(!n(o)){a.innerHTML="";const t=[].concat(o);for(const n of t){const t=w(n,e,u);t&&a.appendChild(t)}}}else if(n(o)){const t=a.children[i];t&&a.removeChild(t)}else if(n(c)){const t=w(o,e,u);t&&a.appendChild(t)}else{const t=a.children[i],n=w(o,e,u);n&&t&&a.replaceChild(n,t)}};if(o($)){const e=$;c(m.$$watch(t,e,c),void 0,t)}else c($,void 0,t)}return a}function g(t,e,c,...i){for(const s in c){const a=c[s];if(r(a)){const n=e[s];n&&g(t,n,a,...i,s)}else if(!n(a)){const n=t=>{e[s]=t};if(o(a)){const e=[].concat(i,s).join("."),o=a;n(t.$$watch(e,o,n))}else n(a)}}}function b(t,e){if(r(t)&&(e=t,t=null),!c(t)){const{path:e}=v(location.hash);t=e}location.hash=function(t,e){const n=[];for(const t in e)n.push(`${t}=${e[t]}`);let o=t?`#${t}`:"#";n.length&&(o+=`?${n.join("&")}`);return o}(t,e)}function v(t){const e={},n=/[?&]([^=]+)=([^&]*)/g;let o=n.exec(t);const c=decodeURIComponent;for(;o;){e[c(o[1])]=c(o[2]),o=n.exec(t)}return{path:c((/^#([^?]+)/.exec(t)||[])[1]||""),query:e}}t.createL10n=function(t,e){const{lang:n=navigator.language,fallback:o="en",context:i}=e||{};function s(e,n,i){if(c(n)&&(i=n,n=null),i||(i=a.$lang),i&&t[i]||(i=o),!i)return e;let s=`${e}`.split(".").reduce(((t,e)=>r(t)?t[e]:""),t[i]);for(const t in n){const e=new RegExp(`%{${t}}`,"g");s=s.replace(e,n[t])}return s}const a=l({lang:t[n]?n:o,locales:Object.keys(t),t:()=>s},i);return Object.seal(a),a},t.createRPC=function(t){const{url:e="/api/rpc",method:n="POST",headers:o={},mode:c,credentials:i}=t,s={};return Object.seal(s),new Proxy(s,{get:(t,s)=>async function(t){const a={};if(t instanceof File||t instanceof Blob){const e=new FormData;e.append("file",t),t=e}else r(t)?(a["Content-Type"]="application/json",t=JSON.stringify(t)):t=`${t}`;const f=await fetch(`${e}/${s}`,{method:n,mode:c,credentials:i,headers:Object.defineProperties(a,{...Object.getOwnPropertyDescriptors(o)}),body:t});if(!f.ok)throw Error(f.statusText);const u=f.headers.get("content-type")||"";return/^application\/json/.test(u)?await f.json():/^application\/octet-stream/.test(u)?await f.blob():await f.text()}})},t.createRouter=function(t,e){const{home:n,context:o}=e||{};function c(){if((!location.hash||"#"===location.hash)&&n)return location.hash=n;const{path:e,query:o}=v(location.hash);i.query||(i.query={});for(const t in i.query)s(o,t)||delete i.query[t];for(const t in o)i.query[t]!==o[t]&&(i.query[t]=o[t]);for(const n in t){const o=t[n],c=e.match(o);i.params[n]=c&&c[1]}i.path=e}const i=l({path:"",params:{},query:{},navigate:()=>b},o);return Object.seal(i),c(),i.$$on("*",(()=>{b(i.path,i.query)})),window.addEventListener("hashchange",(()=>c())),i},t.createState=l,t.createSync=function(t,e,n){const{slippage:o}=n||{};let c;const i=async(...n)=>{const o=c,i=t.$$clone();return c=await e(i,o,...n),r(c)&&t.$$patch(c),c};let s;return"number"==typeof o?async function(...t){return new Promise((e=>{clearTimeout(s),s=setTimeout((async()=>e(await i(...t))),s?o:0)}))}:i},t.createView=function(t,e){const{target:n,context:o}=e||{},c=w(t,o),i=n||c;if(i){const t=function(t){const e=new MutationObserver((function(t){const e=(t,n)=>{const o=t.children;for(let t=0;t<o.length;t++)e(o[t],n);const c=new CustomEvent(n);t.dispatchEvent(c)};for(const n of t)if("childList"===n.type)n.addedNodes.forEach((t=>{t.nodeType===Node.ELEMENT_NODE&&e(t,"mounted")})),n.removedNodes.forEach((t=>{t.nodeType===Node.ELEMENT_NODE&&e(t,"removed")}));else if("attributes"===n.type){const t=n.target,e=new CustomEvent("changed",{detail:{attributeName:n.attributeName,oldValue:n.oldValue,newValue:t.getAttribute(n.attributeName)}});t.dispatchEvent(e)}}));return e.observe(t,{childList:!0,subtree:!0,attributeOldValue:!0}),e}(i);i.addEventListener("removed",(()=>t.disconnect()),!1),n&&c&&n.appendChild(c)}return c}}));
