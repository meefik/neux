function e(e){return void 0===e}function t(e){return"function"==typeof e}function n(e){return"string"==typeof e}function o(e){return Array.isArray(e)}function s(e){return"object"==typeof e&&null!==e&&(e.constructor===Object||e.constructor===Array)}class c{#e={};#t;constructor(e){this.#t=e}on(e,t){if(e&&t){const n=this.#e,o=[].concat(e);for(const e of o)n[e]||(n[e]=new Map),n[e].set(t,!1)}}once(e,t){if(e&&t){const n=this.#e,o=[].concat(e);for(const e of o)n[e]||(n[e]=new Map),n[e].set(t,!0)}}off(e,t){if(e){const n=this.#e,o=[].concat(e);for(const e of o)n[e]&&(t?(n[e].delete(t),n[e].size||delete n[e]):(n[e].clear(),delete n[e]))}else this.#e={}}emit(e,...t){const n=this.#e;if("*"===e)for(const e in n)for(const[o,s]of n[e])o.apply(this.#t,t),s&&this.off(e,o);else{const o=new Set([].concat(e));for(const e of o)if(n[e])for(const[o,s]of n[e])o.apply(this.#t,t),s&&this.off(e,o)}}}const i=Symbol("state"),r=Symbol("context"),a=/^\$([^$]|$)/u,l={};function f(e,t,n,o){const s=e[r];if(s){const e=s.get(t)||{};e[n]=o||null,s.set(t,e)}}function u(t,n,o,s,c){return c.emit(o),function(e,t,n){if(e[r])throw Error("Collision in state binding");const o=new Map;e[r]=o;const s=t();delete e[r];for(const e of o){const[t,o]=e;for(const e in o)n(t,e,o[e])}return s}(t,(()=>s.call(t,n,o)),((i,r,a)=>{const l=a?(s,c,i,r)=>{const l=n[o],f=parseInt(i,10);if(e(s))l.splice(f,1);else if(e(c)){const e=a.call(t,s,f,r);l[f]=e}else{const e=a.call(t,s,f,r);l.splice(f,1,e)}}:()=>{const e=s.call(t,n,o);n[o]=e};i.$$on(r,l),c.once(o,(()=>i.$$off(r,l)))}))}function $(e,t,n,o){if(o.emit(t),n[i]){const s=(n,o,s,c,i=[])=>{e.$$emit([t,"*"],n,o,s,c,[...i,t])};n.$$on("*",s),o.once(t,(()=>n.$$off("*",s)))}}function d(e){if(!s(e))return e;const t=o(e)?[]:{};for(const n in e)t[n]=d(e[n]);return t}function p(t,n,c){const i=o(n);for(const r in t)if(s(t[r]))if(s(n[r]))p(t[r],n[r],c);else{const e=y(o(t[r])?[]:{},c);p(t[r],e,c),i?n.splice(parseInt(r,10),1,e):n[r]=e}else e(t[r])||(i?n.splice(parseInt(r,10),1,t[r]):n[r]=t[r]);if(i){const e=o(t)?t.length:0,s=n.length-e;s>0&&n.splice(e,s)}else for(const o in n)t&&!e(t[o])||delete n[o]}function h(t,n){if(s(t)&&s(n)){for(const o in n)if(e(t[o]))return!1;for(const e in t)if(!h(t[e],n[e]))return!1}else if(t!==n)return!1;return!0}function m(e,t){let n=!0;for(const o in t)if(e[o]!==t[o]){n=!1;break}return n}function g(t,n){if(m(t,n))return t;for(const o in t){const c=t[o];if(s(c)){const t=g(c,n);if(!e(t))return t}}}function w(e,t,n=[]){m(e,t)&&n.push(e);for(const o in e){const c=e[o];s(c)&&w(c,t,n)}return n}function y(r,m){if(e(r))r={};else if(!s(r)||r[i])return r;const{context:v=l}=m||{},b=new c(v),M=new c,T=new c,x=new Proxy(r,{get:(e,o)=>o===i||(n(o)&&a.test(o)&&(t(e[o=o.slice(1)])||f(v,x,o)),Reflect.get(e,o)),set:(e,c,i)=>{if(n(c)&&a.test(c)){const e=c.slice(1)||"*";return t(i)&&b.on(e,i),!0}const r=d(e[c]);if(t(i)){i=u(v,x,c,i,T)}s(i)&&(i=y(i,m),$(x,c,i,M));const l=e[c]!==i||"length"===c&&o(e);if(!Reflect.set(e,c,i))return!1;if(l){const t=[c];o(e)&&isNaN(c)||t.push("*"),o(e)&&!isNaN(c)&&t.push("#"),b.emit(t,i,r,c,x)}return!0},deleteProperty:(e,t)=>{if(n(t)&&a.test(t)){const e=t.slice(1)||"*";return b.off(e),!0}const s=d(e[t]);if(!Reflect.deleteProperty(e,t))return!1;M.emit(t),T.emit(t);const c=[t];return o(e)&&isNaN(t)||c.push("*"),o(e)&&!isNaN(t)&&c.push("#"),b.emit(c,void 0,s,t,x),!0}}),D={configurable:!1,enumerable:!1,writable:!1};Object.defineProperties(x,{$$:{...D,value:e=>x["$"+e]},$$on:{...D,value:(...e)=>b.on(...e)},$$once:{...D,value:(...e)=>b.once(...e)},$$off:{...D,value:(...e)=>b.off(...e)},$$emit:{...D,value:(...e)=>b.emit(...e)},$$query:{...D,value:e=>g(x,e)},$$queryAll:{...D,value:e=>w(x,e)},$$create:{...D,value:e=>y(e,m)},$$clone:{...D,value:(e=x)=>d(e)},$$equal:{...D,value:(e,t=x)=>h(e,t)},$$patch:{...D,value:(e,t=x)=>p(e,t,m)},$$each:{...D,value(e,n){if(o(x))return t(e)&&f(v,x,"#",e.bind(n)),x.map(e,n).filter((e=>e))}}});for(const e in r){if(t(r[e])){const t=r[e];if(n(e)&&a.test(e)){const n=e.slice(1)||"*";b.on(n,t),delete r[e]}else{const n=u(v,x,e,t,T);r[e]=n}}if(s(r[e])){const t=y(r[e],m);r[e]=t,$(x,e,t,M)}}return x}function v(e,t){if(!s(e))return;const{document:o,Element:c}=window;let{tagName:i="div",namespaceURI:r=t,outerHTML:a,el:l}=e;"svg"===i?r="http://www.w3.org/2000/svg":"math"===i?r="http://www.w3.org/1998/Math/MathML":"http://www.w3.org/1999/xhtml"===t&&(r=null),l instanceof c!=!0&&(l=r?o.createElementNS(r,i):o.createElement(i)),n(a)&&(l.innerHTML=a,l.firstChild instanceof c&&(l=l.firstChild));const f={configurable:!1,enumerable:!0,writable:!1},u={tagName:{...f,value:i},namespaceURI:{...f,value:r},outerHTML:{...f,value:a},el:{...f,value:l}};Object.defineProperties(e,u);for(const t in e)if(!u[t]){b(e[t],void 0,t,e)}return l}function b(n,s,c,i){const r=i.el;if(r)if("on"===c){for(const e in n){const o=n[e];t(o)&&r.addEventListener(e,o)}for(const o in s)if(!n||e(n[o])){const e=s[o];t(e)&&r.removeEventListener(o,e)}i.$$on("on",((n,o,s)=>{e(n)?t(o)&&r.removeEventListener(s,o):t(n)&&r.addEventListener(s,n)}))}else if("classList"===c)r.classList=o(n)?n.join(" "):n||"",i.$$on("classList",((e,t,n,s)=>{r.classList=o(s)?s.join(" "):s||""}));else if("attributes"===c){for(const t in n){const o=n[t];e(o)||r.setAttribute(t,o)}for(const t in s)n&&!e(n[t])||r.removeAttribute(t);i.$$on("attributes",((t,n,o)=>{e(t)?r.removeAttribute(o):r.setAttribute(o,t)}))}else if("style"===c){const{style:t}=r;for(const e in n)t[e]=n[e];for(const o in s)n&&!e(n[o])||t.removeProperty(o);i.$$on("style",((n,o,s)=>{e(n)?t.removeProperty(s):/[A-Z]/u.test(s)?t[s]=n:t.setProperty(s,n)}))}else if("dataset"===c){const{dataset:t}=r;for(const o in n){const s=n[o];e(s)||(t[o]=s)}for(const o in s)e(n[o])&&delete t[o];i.$$on("dataset",((n,o,s)=>{e(n)?delete t[s]:t[s]=n}))}else if("children"===c){if(r.innerHTML="",o(n)){for(const e of n){const t=v(e,r.namespaceURI);t&&r.appendChild(t)}i.children.$$on("#",((t,n)=>{if(e(t)){const e=n?.el;e&&r.removeChild(e)}else if(e(n)){const e=v(t,r.namespaceURI);e&&r.appendChild(e)}else{const e=n?.el;if(e){const n=v(t,r.namespaceURI);n&&r.replaceChild(n,e)}}}))}}else e(n)?delete r[c]:e(r[c])||(r[c]=n)}function M(e,t){const{target:n,context:o}=t||{},s=y(e,{context:o}),c=v(s);s.$$on("*",b);const i=function(e){const{MutationObserver:t,CustomEvent:n,Element:o}=window,{ELEMENT_NODE:s}=o,c=new t((e=>{const t=(e,o)=>{const{children:s}=e;for(let e=0;e<s.length;e++)t(s[e],o);const c=new n(o);e.dispatchEvent(c)};for(const o of e)if("childList"===o.type)o.addedNodes.forEach((e=>{e.nodeType===s&&t(e,"mounted")})),o.removedNodes.forEach((e=>{e.nodeType===s&&t(e,"removed")}));else if("attributes"===o.type){const e=o.target,{attributeName:t}=o,{oldValue:s}=o,c=e.getAttribute(t);if(s!==c){const o=new n("changed",{detail:{attributeName:t,oldValue:s,newValue:c}});e.dispatchEvent(o)}}}));return c.observe(e,{childList:!0,subtree:!0,attributeOldValue:!0}),c}(n||c);return c.addEventListener("removed",(e=>{e.target===c&&i.disconnect()}),!1),n&&n.appendChild(c),s}function T(e,t){const n=-1*new Date(e).getTimezoneOffset();return`${n>=0?"+":""}${t?""+~~(n/60):("0"+~~(n/60)).slice(-2)}:${("0"+~~(n%60)).slice(-2)}`}function x(e,t){const{lang:o=navigator.language,fallback:c="en",prefix:i,context:r}=t||{},a=(t,o,i)=>{if(n(o)&&(i=o,o=null),i||(i=f.$lang),i&&e[i]||(i=c),!i)return t;let r=`${t}`.split(".").reduce(((e,t)=>s(e)?e[t]:""),e[i]);for(const e in o){const t=new RegExp(`%\\{${e}\\}`,"gu");r=r.replace(t,o[e])}return r},l=(e,t,n)=>{const o=i?`${i}.`:"";e=new Date(e);const s=()=>n?e.getUTCFullYear():e.getFullYear(),c=()=>n?e.getUTCMonth():e.getMonth(),r=()=>n?e.getUTCDate():e.getDate(),l=()=>n?e.getUTCDay():e.getDay(),f=()=>n?e.getUTCHours():e.getHours(),u=()=>n?e.getUTCMinutes():e.getMinutes(),$=()=>n?e.getUTCSeconds():e.getSeconds(),d=()=>{const e=n?Date.UTC(s(),0,0):new Date(s(),0,0).getTime(),t=n?Date.UTC(s(),c(),r()):new Date(s(),c(),r()).getTime();return Math.round((t-e)/864e5)},p={YYYY:()=>`000${s()}`.slice(-4),YY:()=>`0${s()}`.slice(-2),Q:()=>`${Math.ceil((c()+1)/3)}`,MMMM:()=>a(`${o}month.full.${c()}`),MMM:()=>a(`${o}month.short.${c()}`),MM:()=>`0${c()+1}`.slice(-2),M:()=>`${c()+1}`,DD:()=>`0${r()}`.slice(-2),D:()=>`${r()}`,DDDD:()=>`00${d()}`.slice(-3),DDD:()=>`${d()}`,dddd:()=>a(`${o}day.full.${l()}`),ddd:()=>a(`${o}day.short.${l()}`),HH:()=>`0${f()}`.slice(-2),H:()=>`${f()}`,hh:()=>`0${f()>12?f()-12:f()||12}`.slice(-2),h:()=>`${f()>12?f()-12:f()||12}`,kk:()=>`0${f()+1}`.slice(-2),k:()=>`${f()+1}`,mm:()=>`0${u()}`.slice(-2),m:()=>`${u()}`,ss:()=>`0${$()}`.slice(-2),s:()=>`${$()}`,X:()=>""+e.getTime()/1e3,x:()=>`${e.getTime()}`,a:()=>a(f()<12?`${o}time.am.0`:`${o}time.pm.0`),A:()=>f()<12?a(`${o}time.am.1`):a(`${o}time.pm.1`),ZZ:()=>n?"+00:00":T(e),Z:()=>n?"+0:00":T(e,!0)};for(const e in p){const n=new RegExp(`\\{${e}\\}`,"gu");t=t.replace(n,p[e])}return t},f=y({lang:e[o]?o:c,locales:Object.keys(e),t:()=>a,d:()=>l,translate:()=>a,dateToLocaleString:()=>l},{context:r});return Object.seal(f),f}function D(e){const t={},n=/[?&](?<key>[^=]+)=(?<val>[^&]*)/gu;let o=n.exec(e);const{decodeURIComponent:s}=window;for(;o;){t[s(o.groups.key)]=s(o.groups.val),o=n.exec(e)}const c=/^#(?<path>[^?]+)/u.exec(e);return{path:s(c?.groups.path||""),query:t}}function E(e,t){const{location:o}=window;if(s(e)&&(t=e,e=null),!n(e)){const{path:t}=D(o.hash);e=t}o.hash=function(e,t){const n=[];for(const e in t)n.push(`${e}=${t[e]}`);let o=e?`#${e}`:"#";return n.length&&(o+=`?${n.join("&")}`),o}(e,t)}function C(t,n){const{home:o,context:s}=n||{},{location:c,addEventListener:i}=window,r=y({path:"",params:{},query:{},navigate:()=>E},{context:s});Object.seal(r);const a=()=>{if(c.hash&&"#"!==c.hash||!o){const{path:n,query:o}=D(c.hash);r.query||(r.query={});for(const t in r.query)e(o)&&delete r.query[t];for(const e in o)r.query[e]!==o[e]&&(r.query[e]=o[e]);for(const e in t){const o=t[e],s=n.match(o);r.params[e]=s&&s[1]}r.path=n}else c.hash=o};return a(),r.$$on("*",(()=>{E(r.path,r.query)})),i("hashchange",(()=>a())),r}function L(e){const{url:t="/api/rpc",method:n="POST",headers:o={},mode:c,credentials:i}=e,r={};Object.seal(r);return new Proxy(r,{get:(e,r)=>async function(e){const a={};if(e instanceof FormData);else if(e instanceof File||e instanceof Blob){const t=new FormData;t.append("file",e),e=t}else s(e)?(a["Content-Type"]="application/json",e=JSON.stringify(e)):e=`${e}`;const l=await fetch(`${t}/${r}`,{method:n,mode:c,credentials:i,headers:Object.defineProperties(a,{...Object.getOwnPropertyDescriptors(o)}),body:e});if(!l.ok)throw Error(l.statusText);const f=l.headers.get("content-type")||"";return/^application\/json/u.test(f)?await l.json():/^application\/octet-stream/u.test(f)?await l.blob():await l.text()}})}function N(e,t,n){const{slippage:o}=n||{};let c=null;const i=async(...n)=>{const o=c,i=e.$$clone(),r=await t(i,o,...n);return s(r)&&e.$$patch(r),c=r};let r=null;return"number"==typeof o?(...e)=>new Promise((t=>{clearTimeout(r),r=setTimeout((async()=>t(await i(...e))),r?o:0)})):i}export{x as createL10n,L as createRPC,C as createRouter,y as createState,N as createSync,M as createView};
