function t(t){return void 0===t}function e(t){return"function"==typeof t}function n(t){return"string"==typeof t}function o(t){return Array.isArray(t)}function c(t){return"object"==typeof t&&null!==t&&(t.constructor===Object||t.constructor===Array)}function s(t){return t instanceof Date}const r=Symbol("context"),i={};function l(t){return c(t)?t:i}function a(t,e,n,o){const c=t[r];if(c){const t=c.get(e)||{};t[n]=o||null,c.set(e,t)}}function f(t,e,n){if(t[r])throw Error("Collision in signal binding");const o=new Map;t[r]=o;const c=e();delete t[r];for(const t of o){const[e,o]=t;for(const t in o)n(e,t,o[t])}return c}class u{constructor(t){this._lst={},this._ctx=t}on(t,e,n){if(t&&e){const o=this._lst,c=[].concat(t);for(const t of c)o[t]||(o[t]=new Map),o[t].set(e,n)}}once(t,e){this.on(t,e,!0)}off(t,e){if(t){const n=this._lst,o=[].concat(t);for(const t of o)n[t]&&(e?(n[t].delete(e),n[t].size||delete n[t]):(n[t].clear(),delete n[t]))}else this._lst={}}emit(t,...e){if(t){const n=this._lst,o=[].concat(t);for(const t of o)if(n[t])for(const[o,c]of n[t]){c&&this.off(t,o);try{o.apply(this._ctx,e)}catch(t){console.error(t)}}}}}const d=Symbol("signal");function h(t){let e=0;if(n(t))for(;t.startsWith("$");)t=t.slice(1),e++;return[e>0&&(t||(e>1?"*":"#")),t]}function m(t,e,n,o,c){return c.emit(n),f(t,o=o.bind(t,e,n),((t,s)=>{const r=()=>{e[n]=o()};t.$$on(s,r),c.once(n,(()=>t.$$off(s,r)))}))}function p(t,e,n,o){if(o.emit(e),n[d]){const c=(n,o,c,s,r=[])=>{t.$$emit("*",n,o,c,s,[...r,e])};n.$$on("*",c),o.once(e,(()=>n.$$off("*",c)))}}function w(n,o){const c=l(this),s=e(n)?n.bind(c):()=>n,r=o?o.bind(c):()=>{},i=[],a=f(c,s,((n,l,a)=>{const f="#"===l&&e(a)?a.bind(c):null,u=f?(e,n,c,s)=>{const r=+c,i=t(e)?e:f(e,r,s);o(i,r,s)}:()=>{const t=s();r(t)};n.$$on(l,u),i.push((()=>n.$$off(l,u)))}));r(a);return()=>{for(const t of i)t()}}function g(t={}){if(!c(t)||t[d])return t;const n=l(this),s=new u(n),r=new u,i=new u,f={$$on:(t,e)=>s.on(t,e),$$once:(t,e)=>s.once(t,e),$$off:(t,e)=>s.off(t,e),$$emit:(t,...e)=>s.emit(t,...e)},w=new Proxy(t,{get:(t,e)=>{if(e===d)return!0;if(e in f)return f[e];const[c,s]=h(e);if(c){if("map"===s&&o(t))return(t,e=n)=>(a(n,w,"#",t.bind(e)),w.map(t,e));if(a(n,w,c),!s)return w}return Reflect.get(t,s)},set:(t,l,a)=>{const[f]=h(l);if(f)return!1;const u=t[l];if(e(a)){a=m(n,w,l,a,i)}c(a)&&(a=g.call(n,a),p(w,l,a,r));const d="length"===l&&o(t),y=t[l]!==a||d;return!!Reflect.set(t,l,a)&&(y&&s.emit(d?l:[l,"#","*"],a,u,l,w),!0)},deleteProperty:(t,e)=>{const[n]=h(e);if(n)return!1;const o=t[e];return!!Reflect.deleteProperty(t,e)&&(r.emit(e),i.emit(e),s.emit([e,"#","*"],void 0,o,e,w),!0)}});for(let o in t){const[s]=h(o);if(!s){if(e(t[o])){const e=t[o];t[o]=m(n,w,o,e,i)}if(c(t[o])){const e=g.call(n,t[o]);t[o]=e,p(w,o,e,r)}}}return w}function y(s,r){const{document:i,Node:a,CustomEvent:f}=window,u=l(this);if(e(s)&&(s=s.call(u)),n(s))return i.createTextNode(s);if(!c(s))return s;if(o(s)){const t=i.createDocumentFragment();for(const e of s){const n=y.call(u,e,r);n instanceof a&&t.appendChild(n)}return t}const{tag:d,tagName:h="div",namespaceURI:m=r,shadowRootMode:p,adoptedStyleSheets:g,classList:v,attributes:b,style:$,dataset:E,on:L,children:N,ref:C,...A}=s,M=function(t,e){const{document:o,customElements:c,Element:s}=window,r=[];let i,l,a="div";if(n(t))if(/[^a-zA-Z0-9-_.#]/u.test(t)){const e=o.createElement("div");e.innerHTML=t,e.firstChild instanceof s&&(i=e.firstChild,a=i.tagName)}else{const e=t.match(/([.#]?[^\s#.]+)/gu)||[];for(const t of e){const e=t[0];"."===e?r.push(t.slice(1)):"#"===e?l=t.slice(1):a=t}}else t instanceof s&&(i=t,a=i.tagName);if(!i){const t=c?.get(a);if(t)i=new t;else{if("http://www.w3.org/1999/xhtml"===e&&(e=null),!e)switch(`${a}`.toLowerCase()){case"svg":e="http://www.w3.org/2000/svg";break;case"math":e="http://www.w3.org/1998/Math/MathML"}i=e?o.createElementNS(e,a):o.createElement(a)}}return l&&(i.id=l),r.length&&(i.className=r.join(" ")),i}(d??h,m);let S;r=M.namespaceURI,p&&(S=M.attachShadow({mode:p}),S&&g&&(S.adoptedStyleSheets=g));const _=[],x=(t,n)=>{if(e(t)){const e=w.call(u,t,n);_.push(e)}else n(t)};if(!t(L))for(const t in L){const n=L[t];e(n)&&M.addEventListener(t,(t=>n.call(u,t)))}const P=({children:t},e)=>{for(const n of t){const t=new f(e,{cancelable:!0});n.dispatchEvent(t)}};M.addEventListener("mounted",(t=>{t.defaultPrevented||P(M,"mounted")})),M.addEventListener("removed",(t=>{if(!t.defaultPrevented){P(M,"removed");for(const t of _)t()}})),t(v)||x(v,(t=>{Array.isArray(t)?M.classList=t.filter(Boolean).join(" "):n(t)&&(M.classList=t)})),t(b)||x(b,(e=>{for(const n in e)x(e[n],(e=>{t(e)?M.removeAttribute(n):M.setAttribute(n,e)}))})),t($)||x($,(e=>{for(const n in e)x(e[n],(e=>{/[A-Z]/u.test(n)?t(e)?delete M.style[n]:M.style[n]=e:t(e)?M.style.removeProperty(n):M.style.setProperty(n,e)}))})),t(E)||x(E,(e=>{for(const n in e)x(e[n],(e=>{t(e)?delete M.dataset[n]:M.dataset[n]=e}))}));for(const e in A)x(A[e],(n=>{t(n)?delete M[e]:M[e]=n}));if(!t(N)){const e=S||M;x(N,((n,o,c)=>{if(c)if(t(n)){const t=e.children[o];t&&e.removeChild(t)}else if(e.children[o]){const t=e.children[o];if(t){const o=y.call(u,n,r);o&&e.replaceChild(o,t)}}else{const t=y.call(u,n,r);t&&e.appendChild(t)}else{e.innerHTML="";const t=y.call(u,n,r);t instanceof a&&e.appendChild(t)}}))}return e(C)&&C.call(u,M),M}function v(t,e,n){return o(t)?y.call(this,t):(c(t)&&(n=e,e=t,t=null),c(e)&&!o(e)||(n=e,e={}),y.call(this,{tag:t,children:n,...e}))}function b(t,e){const{MutationObserver:o,CustomEvent:c,Element:s,document:r}=window,{ELEMENT_NODE:i}=s,l=(t,e)=>{if(t.nodeType!==i)return;const n=new c(e,{cancelable:!0});t.dispatchEvent(n)};n(e)&&(e=r.querySelector(e));const a=new o((e=>{for(const n of e)if("childList"===n.type)n.addedNodes.forEach((t=>{t.parentElement&&l(t,"mounted")})),n.removedNodes.forEach((e=>{e.parentElement||l(e,"removed"),e===t&&a.disconnect()}));else if("attributes"===n.type){const t=n.target,{attributeName:e}=n,{oldValue:o}=n,s=t.getAttribute(e);if(o!==s){const n=new c("changed",{detail:{attributeName:e,oldValue:o,newValue:s}});t.dispatchEvent(n)}}}));a.observe(e,{childList:!0,subtree:!0,attributeOldValue:!0}),e.appendChild(t)}function $(t,e){const{language:r=navigator.language,fallback:i="en"}=e||{};return(e,l,a=r)=>{n(l)&&(a=l,l=null),a&&t[a]||(a=i);let f=`${e}`.split(".").reduce(((t,e)=>c(t)?t[e]:""),t[a]);if(n(f))for(const t in l){const e=new RegExp(`%\\{${t}\\}`,"gu");let n=l[t];if(o(n)){const[t,e]=n;n=t,c(e)&&("number"==typeof t||s(t))&&(n=t.toLocaleString(a,e))}f=f.replace(e,n)}return f}}export{w as effect,$ as l10n,b as mount,v as render,g as signal};
